---
title: "Labelled litter incubation"
author: "Itamar Shabtai"
date: "4/28/2020"
output: html_document
---

```{r setup, include=FALSE}
source(here("./scripts/full_incubation_script.R"))
knitr::opts_chunk$set(echo = TRUE)
```

This document summarizes the incubation of high-Ca SI soils wth dual-labelled litter (willow leaves). Soils were pre-incubated with CaCl~2~ (200 meq/L) or DW (as control) at a GWC of 0.55 g/g for one week, leached until EC < 0.1 mS/cm, air dried, and mixed with litter (2% g/g) in Qorpaks jars. Qorpaks and scintillation vials filled with 15 mL KOH (0.18 M) were placed inside gas-tight jars. The amount of CO~2~ emitted (mL) was calculated using a calibration curve made with similar jars w/o any soil into which a known volume of CO~2~ was injected. 24 hours after injection the EC of the KOH solution was measured.

## CO2 emission
```{r cumulative CO2 emission, echo=FALSE}
emission_plot
```

## Mineralization
```{r mineralization, echo = FALSE}
mineralization_plot
```

## Mineralizability
```{r mineralizability, echo = FALSE}
mineralizability_plot + 
  scale_fill_brewer(palette = "Set1") + xlim(0,150)

total_mineralization_table
```


## 1-way ANOVA of 4 day mineralization
```{r 4day mineralization ANOVA}
tidy(aov_low_n_four)
tidy(aov_low_y_four)
tidy(aov_high_n_four)
tidy(aov_high_y_four)

HSD.test(aov_low_n_four, trt = "Treatment",console = TRUE)
HSD.test(aov_high_n_four, trt = "Treatment",console = TRUE)
```

## 1-way ANOVA of total mineralization
```{r total mineralization ANOVA}
tidy(aov_low_n)
tidy(aov_low_y)
tidy(aov_high_n)
tidy(aov_high_y)

HSD.test(aov_low_n, trt = "Treatment",console = TRUE, main = "TukeyHSD 40% WFPS without litter")
HSD.test(aov_low_y, trt = "Treatment",console = TRUE, main = "TukeyHSD 40% WFPS with litter")
```

## 2-way ANOVA of total mineralization
```{r total mineralization 2-way ANOVA}
summary(anova_mineralization_2way)
tidy(anova_mineralization_2way)
```

## 3-way ANOVA with interactions
```{r aoc 3way, echo=FALSE}
summary(aov_min_3_way_inter)
tidy(aov_min_3_way_inter)
anova(aov_min_3_way_inter)
emmeans(aov_min_3_way_inter, pairwise ~ Treatment | Moisture*litter)
emmip(aov_min_3_way_inter, Moisture~litter) +
   mytheme
```


